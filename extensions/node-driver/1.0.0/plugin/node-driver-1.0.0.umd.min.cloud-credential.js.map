{"version":3,"sources":["webpack://node-driver-1.0.0/./cloud-credential/openstack.vue?c625","webpack://node-driver-1.0.0//Users/nwm/dev/ui-plugin-examples/node_modules/@rancher/shell/utils/url.ts","webpack://node-driver-1.0.0/./components/BusyButton.vue?7ccc","webpack://node-driver-1.0.0/./components/BusyButton.vue?d134","webpack://node-driver-1.0.0/./components/BusyButton.vue?f99a","webpack://node-driver-1.0.0/./components/BusyButton.vue","webpack://node-driver-1.0.0/cloud-credential/openstack.vue","webpack://node-driver-1.0.0/./cloud-credential/openstack.vue?8494","webpack://node-driver-1.0.0/./cloud-credential/openstack.vue","webpack://node-driver-1.0.0/./components/BusyButton.vue?58be","webpack://node-driver-1.0.0/./cloud-credential/openstack.vue?2f95","webpack://node-driver-1.0.0/./cloud-credential/openstack.vue?1ef8","webpack://node-driver-1.0.0/./components/BusyButton.vue?1d8d","webpack://node-driver-1.0.0/./cloud-credential/openstack.vue?765c","webpack://node-driver-1.0.0/./components/BusyButton.vue?703a","webpack://node-driver-1.0.0/./openstack.ts"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticClass","attrs","value","decodedData","endpoint","step","mode","on","$event","setData","domainName","username","password","ref","canAuthenticate","connect","busy","clear","_v","_s","t","error","_e","hostname","allowBusy","addHostToAllowList","projectOptions","model","callback","$$v","project","expression","staticRenderFns","parse","str","o","options","m","parser","strictMode","exec","Error","uri","i","key","query","queryStr","replace","q","_","$1","$2","name","strict","loose","disabled","tabIndex","componentTestid","clicked","displayLabel","Vue","extend","props","label","type","String","default","undefined","labelKey","Boolean","Number","manual","data","computed","$store","getters","methods","stopPropagation","preventDefault","cb","$set","$emit","focus","$refs","btn","component","components","Banner","BusyButton","LabeledInput","LabeledSelect","required","id","projects","errorAllowHost","driver","created","test","hostInAllowList","console","okay","___CSS_LOADER_API_IMPORT___","exports","push","module","content","__esModule","locals","add","Openstack","constructor","obj","projectDomainName","projectId","projectName","token","userId","annotations","Object","keys","forEach","p","split","length","field","$dispatch","dispatch","baseUrl","url","auth","identity","user","domain","scope","headers","Accept","res","method","redirectUnauthorized","root","_status","_headers","catalog","endpoints","service","iface","find","svc","interface","e","initial","getOptions","v","keypair","network","zone","zoneName","api","mapper","enabled","selected","makeComputeRequest","list","map","k","convertToOptions","found","option","sorted","sort","a","b","localeCompare"],"mappings":"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","file":"node-driver-1.0.0.umd.min.cloud-credential.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('div',{staticClass:\"row\"},[_c('div',{staticClass:\"col span-6\"},[_c('LabeledInput',{attrs:{\"value\":_vm.value.decodedData.endpoint,\"disabled\":_vm.step !== 1,\"label-key\":\"driver.openstack.auth.fields.endpoint\",\"placeholder-key\":\"driver.openstack.auth.placeholders.endpoint\",\"type\":\"text\",\"mode\":_vm.mode},on:{\"input\":function($event){return _vm.value.setData('endpoint', $event);}}})],1),_c('div',{staticClass:\"col span-6\"},[_c('LabeledInput',{attrs:{\"value\":_vm.value.decodedData.domainName,\"disabled\":_vm.step !== 1,\"label-key\":\"driver.openstack.auth.fields.domainName\",\"placeholder-key\":\"driver.openstack.auth.placeholders.domainName\",\"type\":\"text\",\"mode\":_vm.mode},on:{\"input\":function($event){return _vm.value.setData('domainName', $event);}}})],1)]),_c('div',{staticClass:\"row\"},[_c('div',{staticClass:\"col span-6\"},[_c('LabeledInput',{staticClass:\"mt-20\",attrs:{\"value\":_vm.value.decodedData.username,\"disabled\":_vm.step !== 1,\"label-key\":\"driver.openstack.auth.fields.username\",\"placeholder-key\":\"driver.openstack.auth.placeholders.username\",\"type\":\"text\",\"mode\":_vm.mode},on:{\"input\":function($event){return _vm.value.setData('username', $event);}}})],1),_c('div',{staticClass:\"col span-6\"},[_c('LabeledInput',{staticClass:\"mt-20\",attrs:{\"value\":_vm.value.decodedData.password,\"disabled\":_vm.step !== 1,\"label-key\":\"driver.openstack.auth.fields.password\",\"placeholder-key\":\"driver.openstack.auth.placeholders.password\",\"type\":\"password\",\"mode\":_vm.mode},on:{\"input\":function($event){return _vm.value.setData('password', $event);}}})],1)]),_c('BusyButton',{ref:\"connect\",staticClass:\"mt-20\",attrs:{\"label-key\":\"driver.openstack.auth.actions.authenticate\",\"disabled\":_vm.step !== 1 || !_vm.canAuthenticate},on:{\"click\":_vm.connect}}),_c('button',{staticClass:\"btn role-primary mt-20 ml-20\",attrs:{\"disabled\":_vm.busy || _vm.step === 1},on:{\"click\":_vm.clear}},[_vm._v(\" \"+_vm._s(_vm.t('driver.openstack.auth.actions.edit'))+\" \")]),(_vm.error)?_c('Banner',{staticClass:\"mt-20\",attrs:{\"color\":\"error\"}},[_vm._v(\" \"+_vm._s(_vm.error)+\" \")]):_vm._e(),(_vm.errorAllowHost)?_c('Banner',{staticClass:\"allow-list-error\",attrs:{\"color\":\"error\"}},[_c('div',[_vm._v(\" \"+_vm._s(_vm.t('driver.openstack.auth.errors.notAllowed', { hostname: _vm.hostname }))+\" \")]),_c('button',{staticClass:\"btn ml-10 role-primary\",attrs:{\"disabled\":_vm.allowBusy},on:{\"click\":_vm.addHostToAllowList}},[_vm._v(\" \"+_vm._s(_vm.t('driver.openstack.auth.actions.addToAllowList'))+\" \")])]):_vm._e(),(_vm.projects)?_c('div',{staticClass:\"row mt-20\"},[_c('div',{staticClass:\"col span-6\"},[_c('LabeledSelect',{attrs:{\"label-key\":\"driver.openstack.auth.fields.project\",\"options\":_vm.projectOptions,\"searchable\":false},model:{value:(_vm.project),callback:function ($$v) {_vm.project=$$v},expression:\"project\"}})],1)]):_vm._e()],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","type UriField = 'source' | 'protocol' | 'authority' | 'userInfo' | 'user' | 'password' | 'host' | 'port' | 'relative' | 'path' | 'directory' | 'file' | 'queryStr' | 'anchor'\ntype UriFields = {\n  [key in UriField]: string; // eslint-disable-line no-unused-vars\n}\ntype QueryParams = {\n  [key: string]: string\n}\n\ninterface ParsedUri extends UriFields {\n  query: QueryParams;\n}\n\nexport function addParam(url: string, key: string, val: string | string[]): string {\n  let out = url + (url.includes('?') ? '&' : '?');\n\n  // val can be a string or an array of strings\n  if ( !Array.isArray(val) ) {\n    val = [val];\n  }\n  out += val.map((v) => {\n    if ( v === null ) {\n      return `${ encodeURIComponent(key) }`;\n    } else {\n      return `${ encodeURIComponent(key) }=${ encodeURIComponent(v) }`;\n    }\n  }).join('&');\n\n  return out;\n}\n\nexport function addParams(url: string, params: QueryParams): string {\n  if ( params && typeof params === 'object' ) {\n    Object.keys(params).forEach((key) => {\n      url = addParam(url, key, params[key]);\n    });\n  }\n\n  return url;\n}\n\nexport function removeParam(url: string, key: string): string {\n  const parsed = parse(url);\n\n  if ( parsed.query?.[key] ) {\n    delete parsed.query[key];\n  }\n\n  return stringify(parsed);\n}\n\nexport function parseLinkHeader(str: string) {\n  const out: { [key: string]: string} = { };\n  const lines = (str || '').split(',');\n\n  for ( const line of lines ) {\n    const match = line.match(/^\\s*<([^>]+)>\\s*;\\s*rel\\s*=\"(.*)\"/);\n\n    if ( match ) {\n      out[match[2].toLowerCase()] = match[1];\n    }\n  }\n\n  return out;\n}\n\nexport function isMaybeSecure(port: number, proto: string): boolean {\n  const protocol = proto.toLowerCase();\n\n  return portMatch([port], [443, 8443], ['443']) || protocol === 'https';\n}\n\nexport function portMatch(ports: number[], equals: number[], endsWith: string[]): boolean {\n  for (let i = 0; i < ports.length; i++) {\n    const port = ports[i];\n\n    if (equals.includes(port)) {\n      return true;\n    }\n\n    for (let j = 0; j < endsWith.length; j++) {\n      const suffix = `${ endsWith[j] }`;\n      const portStr = `${ port }`;\n\n      if (portStr !== suffix && portStr.endsWith(suffix)) {\n        return true;\n      }\n    }\n  }\n\n  return false;\n}\n\n// parseUri 1.2.2\n// (c) Steven Levithan <stevenlevithan.com>\n// https://javascriptsource.com/parseuri/\n// MIT License\nexport function parse(str: string): ParsedUri {\n  const o = parse.options;\n  const m = o.parser[o.strictMode ? 'strict' : 'loose'].exec(str);\n\n  if (!m) {\n    throw new Error(`Cannot parse as uri: ${ str }`);\n  }\n  const uri = {} as ParsedUri;\n  let i = 14;\n\n  while (i--) {\n    uri[o.key[i]] = m[i] || '';\n  }\n\n  uri.query = {};\n  uri.queryStr.replace(o.q.parser, (_, $1: string, $2: string): string => {\n    if ($1) {\n      uri[o.q.name][$1] = $2;\n    }\n\n    return '';\n  });\n\n  return uri;\n}\n\nparse.options = {\n  strictMode: false,\n  key:        ['source', 'protocol', 'authority', 'userInfo', 'user', 'password', 'host', 'port', 'relative', 'path', 'directory', 'file', 'queryStr', 'anchor'],\n  q:          {\n    name:   'query',\n    parser: /(?:^|&)([^&=]*)=?([^&]*)/g\n  },\n  parser: {\n    strict: /^(?:([^:\\/?#]+):)?(?:\\/\\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\\/?#]*)(?::(\\d*))?))?((((?:[^?#\\/]*\\/)*)([^?#]*))(?:\\?([^#]*))?(?:#(.*))?)/,\n    loose:  /^(?:(?![^:@]+:[^:@\\/]*@)([^:\\/?#.]+):)?(?:\\/\\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\\/?#]*)(?::(\\d*))?)(((\\/(?:[^?#](?![^?#\\/]*\\.[^?#\\/.]+(?:[?#]|$)))*\\/?)?([^?#\\/]*))(?:\\?([^#]*))?(?:#(.*))?)/\n  }\n} as {\n  strictMode: boolean,\n  key: UriField[],\n  q: {\n    name: 'query',\n    parser: RegExp\n  },\n  parser: {\n    strict: RegExp,\n    loose: RegExp\n  }\n};\n\nexport function stringify(uri: ParsedUri): string {\n  let out = `${ uri.protocol }://`;\n\n  if ( uri.user && uri.password ) {\n    out += `${ uri.user }:${ uri.password }@`;\n  } else if ( uri.user ) {\n    out += `${ uri.user }@`;\n  }\n\n  out += uri.host;\n\n  if ( uri.port ) {\n    out += `:${ uri.port }`;\n  }\n\n  out += uri.path || '/';\n\n  out = addParams(out, uri.query || {});\n\n  if ( uri.anchor ) {\n    out += `#${ uri.anchor }`;\n  }\n\n  return out;\n}\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('button',{ref:\"btn\",staticClass:\"btn role-primary\",attrs:{\"disabled\":_vm.disabled,\"tab-index\":_vm.tabIndex,\"data-testid\":_vm.componentTestid + '-async-button'},on:{\"click\":_vm.clicked}},[(_vm.busy)?_c('i',{staticClass:\"icon icon-lg icon-spinner icon-spin\"}):_c('span',{staticClass:\"icon-spacer\"}),_c('span',[_vm._v(_vm._s(_vm.displayLabel))]),_c('span',{staticClass:\"icon-spacer\"})])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","\nimport Vue from 'vue';\n\nexport type AsyncButtonCallback = (success: boolean) => void;\n\nexport default Vue.extend({\n  props: {\n    /**\n     * Mode maps to keys in asyncButton.* translations\n     */\n    label: {\n      type:    String,\n      default: undefined,\n    },\n    labelKey: {\n      type:    String,\n      default: undefined,\n    },\n    disabled: {\n      type:    Boolean,\n      default: false,\n    },\n    tabIndex: {\n      type:    Number,\n      default: null,\n    },\n\n    /**\n     * Inherited global identifier prefix for tests\n     * Define a term based on the parent component to avoid conflicts on multiple components\n     */\n    componentTestid: {\n      type:    String,\n      default: 'busy-button'\n    },\n\n    manual: {\n      type:    Boolean,\n      default: false,\n    },\n  },\n\n  data(): {busy: boolean} {\n    return { busy: false };\n  },\n\n  computed: {\n    displayLabel(): string {\n      if (this.labelKey) {\n        const t = (this as any).$store.getters['i18n/t'];\n\n        return t(this.labelKey);\n      }\n\n      return this.label;\n    }\n  },\n\n  methods: {\n    clicked($event: MouseEvent) {\n      if ($event) {\n        $event.stopPropagation();\n        $event.preventDefault();\n      }\n\n      if ( this.disabled ) {\n        return;\n      }\n\n      const cb: AsyncButtonCallback = () => {\n        this.busy = false;\n      };\n\n      this.$set(this, 'busy', true);\n\n      this.$emit('click', cb);\n    },\n\n    focus() {\n      (this.$refs.btn as HTMLElement).focus();\n    }\n  }\n});\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--15-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/ts-loader/index.js??ref--15-3!../../../node_modules/cache-loader/dist/cjs.js??ref--2-0!../../../node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js??vue-loader-options!./BusyButton.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--15-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/ts-loader/index.js??ref--15-3!../../../node_modules/cache-loader/dist/cjs.js??ref--2-0!../../../node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js??vue-loader-options!./BusyButton.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./BusyButton.vue?vue&type=template&id=60507a65&scoped=true&\"\nimport script from \"./BusyButton.vue?vue&type=script&lang=ts&\"\nexport * from \"./BusyButton.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./BusyButton.vue?vue&type=style&index=0&id=60507a65&prod&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/@vue/cli-service/node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"60507a65\",\n  null\n  \n)\n\nexport default component.exports","<script>\nimport Banner from '@components/Banner/Banner.vue';\nimport { LabeledInput } from '@components/Form/LabeledInput';\nimport LabeledSelect from '@shell/components/form/LabeledSelect';\nimport { parse as parseUrl } from '@shell/utils/url';\nimport { _CREATE } from '@shell/config/query-params';\nimport BusyButton from '../components/BusyButton.vue';\nimport { Openstack } from '../openstack.ts';\n\nexport default {\n  components: {\n    Banner,\n    BusyButton,\n    LabeledInput,\n    LabeledSelect,\n  },\n\n  props: {\n    mode: {\n      type:     String,\n      required: true,\n    },\n\n    value: {\n      type:     Object,\n      required: true,\n    },\n  },\n\n  async fetch() {\n    this.driver = await this.$store.dispatch('rancher/find', {\n      type: 'nodedriver',\n      id:   'openstack'\n    });\n  },\n\n  data() {\n    if (this.mode !== _CREATE) {\n      this.value.decodedData.username = this.value.annotations['openstack.cattle.io/username'];\n      this.value.decodedData.domainName = this.value.annotations['openstack.cattle.io/domainName'];\n      this.value.decodedData.endpoint = this.value.annotations['openstack.cattle.io/endpoint'];\n    }\n\n    return {\n      projects:       null,\n      step:           1,\n      busy:           false,\n      project:        '',\n      errorAllowHost: false,\n      driver:         {},\n      allowBusy:      false,\n      error:          '',\n    };\n  },\n\n  computed: {\n    projectOptions() {\n      const sorted = (this.projects || []).sort((a, b) => a.name.localeCompare(b.name));\n\n      return sorted.map((p) => {\n        return {\n          label: p.name,\n          value: p.id\n        };\n      });\n    },\n\n    hostname() {\n      const u = parseUrl(this.value.decodedData.endpoint);\n\n      return u?.host || '';\n    },\n\n    canAuthenticate() {\n      return !!this.value?.decodedData?.endpoint &&\n        !!this.value?.decodedData?.domainName &&\n        !!this.value?.decodedData?.username &&\n        !!this.value?.decodedData?.password;\n    }\n  },\n\n  created() {\n    this.$emit('validationChanged', false);\n  },\n\n  methods: {\n    // TODO: Validate that we can get a token for the project that the user has selected\n    test() {\n      this.value.annotations['openstack.cattle.io/username'] = this.value.decodedData.username;\n      this.value.annotations['openstack.cattle.io/domainName'] = this.value.decodedData.domainName;\n      this.value.annotations['openstack.cattle.io/endpoint'] = this.value.decodedData.endpoint;\n\n      const project = this.projects.find(p => p.id === this.project);\n\n      if (project) {\n        this.value.annotations['openstack.cattle.io/projectName'] = project.name;\n        this.value.annotations['openstack.cattle.io/projectId'] = project.id;\n        this.value.annotations['openstack.cattle.io/projectDomainName'] = project.domain_id;\n      }\n\n      return true;\n    },\n\n    // When the user clicked 'Edit Auth Config', clear the projects and set the step back to 1\n    // so the user can modify the credentials needed to fetch the projects\n    clear() {\n      this.$set(this, 'step', 1);\n      this.$set(this, 'projects', null);\n      this.$set(this, 'errorAllowHost', false);\n\n      // Tell parent that the form is not invalid\n      this.$emit('validationChanged', false);\n    },\n\n    hostInAllowList() {\n      if (!this.driver?.whitelistDomains) {\n        return false;\n      }\n\n      const u = parseUrl(this.value.decodedData.endpoint);\n\n      if (!u.host) {\n        return true;\n      }\n\n      return (this.driver?.whitelistDomains || []).includes(u.host);\n    },\n\n    async addHostToAllowList() {\n      this.$set(this, 'allowBusy', true);\n      const u = parseUrl(this.value.decodedData.endpoint);\n\n      this.driver.whitelistDomains = this.driver.whitelistDomains || [];\n\n      if (!this.hostInAllowList()) {\n        this.driver.whitelistDomains.push(u.host);\n      }\n\n      try {\n        await this.driver.save();\n\n        this.$refs.connect.$el.click();\n      } catch (e) {\n        console.error('Could not update driver', e); // eslint-disable-line no-console\n        this.$set(this, 'allowBusy', false);\n      }\n    },\n\n    async connect(cb) {\n      this.$set(this, 'error', '');\n      this.$set(this, 'errorAllowHost', false);\n\n      let okay = false;\n\n      if (!this.value.decodedData.endpoint) {\n        return cb(okay);\n      }\n\n      const os = new Openstack(this.$store, {\n        endpoint:   this.value.decodedData.endpoint,\n        domainName: this.value.decodedData.domainName,\n        username:   this.value.decodedData.username,\n        password:   this.value.decodedData.password,\n      });\n\n      this.$set(this, 'allowBusy', false);\n      this.$set(this, 'step', 2);\n      this.$set(this, 'busy', true);\n\n      const res = await os.getToken();\n\n      if (res.error) {\n        console.error(res.error); // eslint-disable-line no-console\n        okay = false;\n\n        this.$set(this, 'step', 1);\n        this.$set(this, 'projects', null);\n\n        if (res.error._status === 502 && !this.hostInAllowList()) {\n          this.$set(this, 'errorAllowHost', true);\n        } else {\n          this.$set(this, 'error', res.error.message);\n        }\n      } else {\n        const projects = await os.getProjects();\n\n        if (!projects.error) {\n          this.$set(this, 'projects', projects);\n          okay = true;\n        } else {\n          this.$set(this, 'error', res.error.message);\n        }\n      }\n      this.$set(this, 'busy', false);\n      this.$set(this, 'project', this.projectOptions[0]?.value);\n      this.$emit('validationChanged', okay);\n\n      cb(okay);\n    }\n  }\n};\n</script>\n\n<template>\n  <div>\n    <div class=\"row\">\n      <div class=\"col span-6\">\n        <LabeledInput\n          :value=\"value.decodedData.endpoint\"\n          :disabled=\"step !== 1\"\n          label-key=\"driver.openstack.auth.fields.endpoint\"\n          placeholder-key=\"driver.openstack.auth.placeholders.endpoint\"\n          type=\"text\"\n          :mode=\"mode\"\n          @input=\"value.setData('endpoint', $event);\"\n        />\n      </div>\n      <div class=\"col span-6\">\n        <LabeledInput\n          :value=\"value.decodedData.domainName\"\n          :disabled=\"step !== 1\"\n          label-key=\"driver.openstack.auth.fields.domainName\"\n          placeholder-key=\"driver.openstack.auth.placeholders.domainName\"\n          type=\"text\"\n          :mode=\"mode\"\n          @input=\"value.setData('domainName', $event);\"\n        />\n      </div>\n    </div>\n    <div class=\"row\">\n      <div class=\"col span-6\">\n        <LabeledInput\n          :value=\"value.decodedData.username\"\n          :disabled=\"step !== 1\"\n          class=\"mt-20\"\n          label-key=\"driver.openstack.auth.fields.username\"\n          placeholder-key=\"driver.openstack.auth.placeholders.username\"\n          type=\"text\"\n          :mode=\"mode\"\n          @input=\"value.setData('username', $event);\"\n        />\n      </div>\n      <div class=\"col span-6\">\n        <LabeledInput\n          :value=\"value.decodedData.password\"\n          :disabled=\"step !== 1\"\n          class=\"mt-20\"\n          label-key=\"driver.openstack.auth.fields.password\"\n          placeholder-key=\"driver.openstack.auth.placeholders.password\"\n          type=\"password\"\n          :mode=\"mode\"\n          @input=\"value.setData('password', $event);\"\n        />\n      </div>\n    </div>\n\n    <BusyButton\n      ref=\"connect\"\n      label-key=\"driver.openstack.auth.actions.authenticate\"\n      :disabled=\"step !== 1 || !canAuthenticate\"\n      class=\"mt-20\"\n      @click=\"connect\"\n    />\n\n    <button\n      class=\"btn role-primary mt-20 ml-20\"\n      :disabled=\"busy || step === 1\"\n      @click=\"clear\"\n    >\n      {{ t('driver.openstack.auth.actions.edit') }}\n    </button>\n\n    <Banner\n      v-if=\"error\"\n      class=\"mt-20\"\n      color=\"error\"\n    >\n      {{ error }}\n    </Banner>\n\n    <Banner\n      v-if=\"errorAllowHost\"\n      color=\"error\"\n      class=\"allow-list-error\"\n    >\n      <div>\n        {{ t('driver.openstack.auth.errors.notAllowed', { hostname }) }}\n      </div>\n      <button\n        :disabled=\"allowBusy\"\n        class=\"btn ml-10 role-primary\"\n        @click=\"addHostToAllowList\"\n      >\n        {{ t('driver.openstack.auth.actions.addToAllowList') }}\n      </button>\n    </Banner>\n    <div\n      v-if=\"projects\"\n      class=\"row mt-20\"\n    >\n      <div class=\"col span-6\">\n        <LabeledSelect\n          v-model=\"project\"\n          label-key=\"driver.openstack.auth.fields.project\"\n          :options=\"projectOptions\"\n          :searchable=\"false\"\n        />\n      </div>\n    </div>\n  </div>\n</template>\n<style lang=\"scss\" scoped>\n  .allow-list-error {\n    display: flex;\n\n    > :first-child {\n      flex: 1;\n    }\n  }\n</style>\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--2-0!../../../node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js??vue-loader-options!./openstack.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--2-0!../../../node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js??vue-loader-options!./openstack.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./openstack.vue?vue&type=template&id=64bdc33a&scoped=true&\"\nimport script from \"./openstack.vue?vue&type=script&lang=js&\"\nexport * from \"./openstack.vue?vue&type=script&lang=js&\"\nimport style0 from \"./openstack.vue?vue&type=style&index=0&id=64bdc33a&prod&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/@vue/cli-service/node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"64bdc33a\",\n  null\n  \n)\n\nexport default component.exports","// Imports\nvar ___CSS_LOADER_API_IMPORT___ = require(\"../../../node_modules/@vue/cli-service/node_modules/css-loader/dist/runtime/api.js\");\nexports = ___CSS_LOADER_API_IMPORT___(false);\n// Module\nexports.push([module.id, \".clearfix[data-v-60507a65]:after,.clearfix[data-v-60507a65]:before{content:\\\" \\\";display:table}.clearfix[data-v-60507a65]:after{clear:both}.list-unstyled[data-v-60507a65]{margin:0;padding:0;list-style-type:none}.no-select[data-v-60507a65]{-webkit-user-select:none;-moz-user-select:none;user-select:none}.no-resize[data-v-60507a65]{resize:none}.hand[data-v-60507a65]{cursor:pointer;cursor:hand}.fixed[data-v-60507a65]{table-layout:fixed}.clip[data-v-60507a65]{text-overflow:ellipsis;overflow:hidden;white-space:nowrap}.clip[data-v-60507a65],.force-wrap[data-v-60507a65]{word-wrap:break-word}.force-wrap[data-v-60507a65]{white-space:normal}.bordered-section[data-v-60507a65]{border-bottom:1px solid var(--border);margin-bottom:20px;padding-bottom:20px}.section-divider[data-v-60507a65]{margin-bottom:20px;margin-top:20px}.icon-spacer[data-v-60507a65]{width:24px}\", \"\"]);\n// Exports\nmodule.exports = exports;\n","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../node_modules/@vue/cli-service/node_modules/css-loader/dist/cjs.js??ref--10-oneOf-1-1!../../../node_modules/@vue/cli-service/node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-2!../../../node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-3!../../../node_modules/sass-loader/dist/cjs.js??ref--10-oneOf-1-4!../../../node_modules/cache-loader/dist/cjs.js??ref--2-0!../../../node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js??vue-loader-options!./openstack.vue?vue&type=style&index=0&id=64bdc33a&prod&lang=scss&scoped=true&\");\nif(content.__esModule) content = content.default;\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar add = require(\"!../../../node_modules/vue-style-loader/lib/addStylesClient.js\").default\nvar update = add(\"6aa29c23\", content, true, {\"sourceMap\":false,\"shadowMode\":false});","export * from \"-!../../../node_modules/vue-style-loader/index.js??ref--10-oneOf-1-0!../../../node_modules/@vue/cli-service/node_modules/css-loader/dist/cjs.js??ref--10-oneOf-1-1!../../../node_modules/@vue/cli-service/node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-2!../../../node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-3!../../../node_modules/sass-loader/dist/cjs.js??ref--10-oneOf-1-4!../../../node_modules/cache-loader/dist/cjs.js??ref--2-0!../../../node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js??vue-loader-options!./openstack.vue?vue&type=style&index=0&id=64bdc33a&prod&lang=scss&scoped=true&\"","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../node_modules/@vue/cli-service/node_modules/css-loader/dist/cjs.js??ref--10-oneOf-1-1!../../../node_modules/@vue/cli-service/node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-2!../../../node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-3!../../../node_modules/sass-loader/dist/cjs.js??ref--10-oneOf-1-4!../../../node_modules/cache-loader/dist/cjs.js??ref--2-0!../../../node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js??vue-loader-options!./BusyButton.vue?vue&type=style&index=0&id=60507a65&prod&lang=scss&scoped=true&\");\nif(content.__esModule) content = content.default;\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar add = require(\"!../../../node_modules/vue-style-loader/lib/addStylesClient.js\").default\nvar update = add(\"4ed41120\", content, true, {\"sourceMap\":false,\"shadowMode\":false});","// Imports\nvar ___CSS_LOADER_API_IMPORT___ = require(\"../../../node_modules/@vue/cli-service/node_modules/css-loader/dist/runtime/api.js\");\nexports = ___CSS_LOADER_API_IMPORT___(false);\n// Module\nexports.push([module.id, \".clearfix[data-v-64bdc33a]:after,.clearfix[data-v-64bdc33a]:before{content:\\\" \\\";display:table}.clearfix[data-v-64bdc33a]:after{clear:both}.list-unstyled[data-v-64bdc33a]{margin:0;padding:0;list-style-type:none}.no-select[data-v-64bdc33a]{-webkit-user-select:none;-moz-user-select:none;user-select:none}.no-resize[data-v-64bdc33a]{resize:none}.hand[data-v-64bdc33a]{cursor:pointer;cursor:hand}.fixed[data-v-64bdc33a]{table-layout:fixed}.clip[data-v-64bdc33a]{text-overflow:ellipsis;overflow:hidden;white-space:nowrap}.clip[data-v-64bdc33a],.force-wrap[data-v-64bdc33a]{word-wrap:break-word}.force-wrap[data-v-64bdc33a]{white-space:normal}.bordered-section[data-v-64bdc33a]{border-bottom:1px solid var(--border);margin-bottom:20px;padding-bottom:20px}.section-divider[data-v-64bdc33a]{margin-bottom:20px;margin-top:20px}.allow-list-error[data-v-64bdc33a]{display:flex}.allow-list-error[data-v-64bdc33a]>:first-child{flex:1}\", \"\"]);\n// Exports\nmodule.exports = exports;\n","export * from \"-!../../../node_modules/vue-style-loader/index.js??ref--10-oneOf-1-0!../../../node_modules/@vue/cli-service/node_modules/css-loader/dist/cjs.js??ref--10-oneOf-1-1!../../../node_modules/@vue/cli-service/node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-2!../../../node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-3!../../../node_modules/sass-loader/dist/cjs.js??ref--10-oneOf-1-4!../../../node_modules/cache-loader/dist/cjs.js??ref--2-0!../../../node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js??vue-loader-options!./BusyButton.vue?vue&type=style&index=0&id=60507a65&prod&lang=scss&scoped=true&\"","/**\n * Helper class for dealing with the Openstack API\n */\nexport class Openstack {\n  public domainName: string = '';\n  public endpoint: string = '';\n  public projectDomainName: string = '';\n  public projectId: string = '';\n  public projectName: string = '';\n  public username: string = '';\n  public password: string = '';\n  public token: string = '';\n  private catalog: any;\n  private endpoints: any;\n  private userId: string = '';\n\n  // private region: string = '';\n\n  private $dispatch: any;\n\n  constructor($store: any, obj: any) {\n    if (obj.annotations) {\n      Object.keys(obj.annotations).forEach((key) => {\n        const p = key.split('/');\n\n        if (p.length === 2 && p[0] === 'openstack.cattle.io') {\n          const field = p[1];\n\n          (this as any)[field] = obj.annotations[key];\n        }\n      });\n    } else {\n      // Copy from options to this\n      Object.keys(obj).forEach((key) => {\n        (this as any)[key] = obj[key];\n      });\n    }\n\n    this.$dispatch = $store.dispatch;\n  }\n\n  public async getToken() {\n    const endpoint = this.endpoint.replace(/^https?:\\/\\//, '');\n    const baseUrl = `/meta/proxy/${ endpoint }`;\n    const url = `${ baseUrl }/auth/tokens`;\n\n    const data = {\n      auth: {\n        identity: {\n          methods:  ['password'],\n          password: {\n            user: {\n              name:     this.username,\n              domain:   { name: this.domainName },\n              password: this.password\n            }\n          }\n        }\n      }\n    };\n\n    if (this.projectName) {\n      (data as any).auth.scope = {\n        project: {\n          name:   this.projectName,\n          domain: { name: this.projectDomainName }\n        }\n      };\n    }\n\n    const headers = { Accept: 'application/json' };\n\n    try {\n      const res = await this.$dispatch('management/request', {\n        url,\n        headers,\n        method:               'POST',\n        redirectUnauthorized: false,\n        data\n      }, { root: true });\n\n      if (res._status === 502) {\n        return { error: 'Could not proxy request - URL may not be in Rancher\\'s allow list' };\n      }\n\n      const token = res._headers['x-subject-token'];\n\n      this.token = token;\n\n      this.userId = res?.token?.user?.id;\n\n      if ((data as any).auth.scope && res?.token) {\n        this.catalog = res.token.catalog;\n        this.endpoints = {};\n        this.catalog.forEach((service: any) => {\n          const iface = service.endpoints.find((svc: any) => svc.interface === 'public');\n\n          if (iface) {\n            this.endpoints[service.type] = iface.url;\n\n            // if (service.importTypes === 'compute') {\n            //   this.region = iface.region;\n            // }\n          }\n        });\n      }\n\n      return res;\n    } catch (e) {\n      console.error(e); // eslint-disable-line no-console\n\n      return { error: e };\n    }\n  }\n\n  public async getFlavors(value: any, initial?: string) {\n    return await this.getOptions(value, '/flavors', 'flavors', undefined, initial);\n  }\n\n  public async getImages(value: any, initial?: string) {\n    return await this.getOptions(value, '/images/detail', 'images', undefined, initial);\n  }\n\n  public async getKeyPairs(value: any, initial?: string) {\n    return await this.getOptions(value, '/os-keypairs', 'keypairs', (v: any) => v.keypair, initial);\n  }\n\n  public async getSecurityGroups(value: any, initial?: string) {\n    return await this.getOptions(value, '/os-security-groups', 'security_groups', undefined, initial);\n  }\n\n  public async getFloatingIpPools(value: any, initial?: string) {\n    return await this.getOptions(value, '/os-floating-ip-pools', 'floating_ip_pools', undefined, initial);\n  }\n\n  public async getNetworkNames(value: any, initial?: string) {\n    return await this.getOptions(value, '/os-tenant-networks', 'networks', (network: any) => {\n      return {\n        ...network,\n        name: network.label\n      };\n    }, initial);\n  }\n\n  public async getAvailabilityZones(value: any, initial?: string) {\n    return await this.getOptions(value, '/os-availability-zone', 'availabilityZoneInfo', (zone: any) => {\n      return {\n        ...zone,\n        name: zone.zoneName\n      };\n    }, initial);\n  }\n\n  public async getOptions(value: any, api: string, field: string, mapper?: Function, initial?: string) {\n    // We are fetching the data for the options\n    value.busy = true;\n    value.enabled = true;\n    value.selected = '';\n\n    const res = await this.makeComputeRequest(api);\n\n    if (res && (res as any)[field]) {\n      let list = (res as any)[field] || [];\n\n      if (mapper) {\n        list = list.map((k: any) => mapper(k));\n      }\n\n      value.options = this.convertToOptions(list);\n      value.busy = false;\n\n      if (initial) {\n        const found = value.options.find((option: any) => option.value.name === initial);\n\n        if (found) {\n          value.selected = found.value;\n        }\n      }\n\n      if (!value.selected && value.options.length > 0) {\n        value.selected = value.options[0].value;\n      }\n    } else {\n      value.options = [];\n      value.selected = null;\n      value.busy = false;\n      value.enabled = false;\n    }\n  }\n\n  public async makeComputeRequest(api: string) {\n    const endpoint = this.endpoints['compute'].replace(/^https?:\\/\\//, '');\n    const baseUrl = `/meta/proxy/${ endpoint }`;\n    const url = `${ baseUrl }${ api }`;\n\n    const headers = {\n      Accept:         'application/json',\n      'X-Auth-Token': this.token\n    };\n\n    try {\n      const res = await this.$dispatch('management/request', {\n        url,\n        headers,\n        method:               'GET',\n        redirectUnauthorized: false,\n      }, { root: true });\n\n      return res;\n    } catch (e) {\n      console.error(e); // eslint-disable-line no-console\n    }\n  }\n\n  public async getProjects() {\n    const endpoint = this.endpoint.replace(/^https?:\\/\\//, '');\n    const baseUrl = `/meta/proxy/${ endpoint }`;\n\n    const headers = {\n      Accept:         'application/json',\n      'X-Auth-Token': this.token\n    };\n\n    try {\n      const res = await this.$dispatch('management/request', {\n        url:                  `${ baseUrl }/users/${ this.userId }/projects`,\n        headers,\n        method:               'GET',\n        redirectUnauthorized: false,\n      }, { root: true });\n\n      return res?.projects;\n    } catch (e) {\n      console.error(e); // eslint-disable-line no-console\n\n      return { error: e };\n    }\n  }\n\n  private convertToOptions(list: any) {\n    const sorted = (list || []).sort((a: any, b: any) => a.name.localeCompare(b.name));\n\n    return sorted.map((p: any) => {\n      return {\n        label: p.name,\n        value: p\n      };\n    });\n  }\n}\n"],"sourceRoot":""}